<!-- homesplits/music.html -->
<section id="music" class="music-player fade-in" data-split="music">
  <style>
    /* Scoped fallback styles (overridden by your global styles if present) */
    section.music-player[data-split="music"] {
      --bg: #ffffff;
      --fg: #14213d;
      --muted: #425066;
      --cardbg: #f7f9fc;
      --shadow: 0 8px 28px rgba(0,0,0,.08);

      background: var(--bg);
      color: var(--fg);
      padding: 4rem 1.25rem;
    }
    body[data-theme="dark"] section.music-player[data-split="music"] {
      --bg: #0e1423;
      --fg: #d8dee9;
      --muted: #a8b2d2;
      --cardbg: #121a2e;
      --shadow: 0 10px 30px rgba(0,0,0,.5);
    }

    section.music-player[data-split="music"] .page-header {
      max-width: var(--content-max, min(75vw, 1200px));
      margin: 0 auto 2rem;
      text-align: center;
    }
    section.music-player[data-split="music"] .page-header h2 {
      font-family: 'Gabarito', system-ui, sans-serif;
      font-weight: 900;
      margin: 0 0 .5rem;
      line-height: 1.2;
      font-size: clamp(1.9rem, 3.5vw, 2.4rem);
      color: var(--fg);
    }
    section.music-player[data-split="music"] .page-header p {
      margin: 0;
      color: var(--muted);
      line-height: 1.7;
      font-size: 1rem;
    }

    section.music-player[data-split="music"] .music-grid {
      max-width: var(--content-max, min(75vw, 1200px));
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.25rem;
    }

    section.music-player[data-split="music"] .music-card {
      background: var(--cardbg);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      min-height: 100%;
    }
    section.music-player[data-split="music"] .music-card > img {
      display: block;
      width: 100%;
      height: 180px;
      object-fit: cover;
      user-select: none;
      -webkit-user-drag: none;
    }
    section.music-player[data-split="music"] .music-content {
      padding: 1rem;
      display: grid;
      gap: .75rem;
    }
    section.music-player[data-split="music"] .track-title {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,.1);
      padding: .6rem .8rem;
      background: rgba(255,255,255,.65);
      color: var(--fg);
      outline: none;
    }
    body[data-theme="dark"] section.music-player[data-split="music"] .track-title {
      border-color: rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }
    section.music-player[data-split="music"] audio {
      width: 100%;
      height: 36px;
    }

    /* Simple EQ bars */
    section.music-player[data-split="music"] .eq-bars {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      align-items: end;
      gap: 6px;
      height: 36px;
    }
    section.music-player[data-split="music"] .eq-bar {
      height: 6px;
      border-radius: 6px;
      background: currentColor;
      opacity: .7;
      transform-origin: bottom;
      animation: eqPulse 1.2s ease-in-out infinite;
      animation-play-state: paused; /* start paused; play when audio plays */
    }
    section.music-player[data-split="music"] .eq-bar:nth-child(2){ animation-delay: .1s; }
    section.music-player[data-split="music"] .eq-bar:nth-child(3){ animation-delay: .2s; }
    section.music-player[data-split="music"] .eq-bar:nth-child(4){ animation-delay: .3s; }
    section.music-player[data-split="music"] .eq-bar:nth-child(5){ animation-delay: .4s; }

    @keyframes eqPulse {
      0%, 100% { transform: scaleY(0.2); }
      50%      { transform: scaleY(1); }
    }

    /* When a card is playing, animate its bars */
    section.music-player[data-split="music"] .music-card.playing .eq-bar {
      animation-play-state: running;
    }
  </style>

  <div class="page-header">
    <h2>Featured Tracks</h2>
    <p>Listen to my latest audio projects.</p>
  </div>

  <div class="music-grid">
    <div class="music-card">
      <img src="assets/tracks/Musings.jpg" alt="Track 1 Album Cover" />
      <div class="music-content">
        <input type="text" class="track-title" value="Rain" />
        <audio controls preload="metadata">
          <source src="assets/tracks/Track 1.mp3" type="audio/mpeg" />
        </audio>
        <div class="eq-bars">
          <div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div>
        </div>
      </div>
    </div>

    <div class="music-card">
      <img src="assets/tracks/Musings.jpg" alt="Track 2 Album Cover" />
      <div class="music-content">
        <input type="text" class="track-title" value="Sonata" />
        <audio controls preload="metadata">
          <source src="assets/tracks/Track 2.mp3" type="audio/mpeg" />
        </audio>
        <div class="eq-bars">
          <div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div>
        </div>
      </div>
    </div>

    <div class="music-card">
      <img src="assets/tracks/Musings.jpg" alt="Track 3 Album Cover" />
      <div class="music-content">
        <input type="text" class="track-title" value="MÃ¼nchhausen" />
        <audio controls preload="metadata">
          <source src="assets/tracks/Track 3.mp3" type="audio/mpeg" />
        </audio>
        <div class="eq-bars">
          <div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div>
        </div>
      </div>
    </div>

    <div class="music-card">
      <img src="assets/tracks/Musings.jpg" alt="Track 4 Album Cover" />
      <div class="music-content">
        <input type="text" class="track-title" value="Growing Old" />
        <audio controls preload="metadata">
          <source src="assets/tracks/Track 4.mp3" type="audio/mpeg" />
        </audio>
        <div class="eq-bars">
          <div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div>
        </div>
      </div>
    </div>

    <div class="music-card">
      <img src="assets/tracks/Musings.jpg" alt="Track 5 Album Cover" />
      <div class="music-content">
        <input type="text" class="track-title" value="The Adventure Begins" />
        <audio controls preload="metadata">
          <source src="assets/tracks/Track 5.mp3" type="audio/mpeg" />
        </audio>
        <div class="eq-bars">
          <div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const section = document.querySelector('section.music-player[data-split="music"]');
      if (!section) return;

      const cards  = Array.from(section.querySelectorAll('.music-card'));
      const audios = Array.from(section.querySelectorAll('audio'));

      // Pause all others when one starts
      audios.forEach((a) => {
        a.addEventListener('play', () => {
          audios.forEach(b => { if (b !== a) b.pause(); });
          cards.forEach(c => c.classList.remove('playing'));
          const card = a.closest('.music-card');
          if (card) card.classList.add('playing');
        });
        a.addEventListener('pause', () => {
          const card = a.closest('.music-card');
          if (card) card.classList.remove('playing');
        });
        a.addEventListener('ended', () => {
          const card = a.closest('.music-card');
          if (card) card.classList.remove('playing');
        });
      });
    })();
  </script>
</section>
