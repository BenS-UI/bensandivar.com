<!-- homesplits/projects.html -->
<section id="projects" class="featured-projects fade-in" data-split="projects">
  <div class="page-header">
    <h2>Featured Projects</h2>
    <p>Check out some of my standout work.</p>
  </div>

  <!-- JS turns this into a 3D carousel -->
  <div class="projects-grid" aria-label="Featured projects carousel">
    <!-- Teaching -->
    <div class="project-card" data-tilt data-section="teaching">
      <img src="assets/projects/LEAP%20(2).jpg" alt="LEAP Thumbnail" />
      <div class="card-content">
        <h4>LEAP</h4>
        <p>Language learning method blending multi-style integration, premium design, and data-driven science.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="teaching">
      <img src="assets/projects/SLIDES.png" alt="SLIDES Thumbnail" />
      <div class="card-content">
        <h4>SLIDES</h4>
        <p>Visual vocabulary tool with 4,000+ curated assets and spaced-repetition learning.</p>
      </div>
    </div>

    <!-- Design -->
    <div class="project-card" data-tilt data-section="design">
      <img src="assets/projects/Personal%20Branding.jpg" alt="Personal Branding Thumbnail" />
      <div class="card-content">
        <h4>Personal Branding</h4>
        <p>Custom logo and color system reflecting vision, values, and mission identity.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="design">
      <img src="assets/projects/Gente Como Tú.jpg" alt="Cover Art Thumbnail" />
      <div class="card-content">
        <h4>Cover Art</h4>
        <p>Collage-style cover art inspired by David Carson’s bold graphic design.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="design">
      <img src="assets/projects/poster.jpg" alt="Concert Poster Design Thumbnail" />
      <div class="card-content">
        <h4>Concert Poster Design</h4>
        <p>Debut concert poster with striking colors, influencing cover art and lyric video.</p>
      </div>
    </div>

    <!-- Apps & AI -->
    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/Emma.jpg" alt="Emma Thumbnail" />
      <div class="card-content">
        <h4>Emma</h4>
        <p>Artificial Human prototype with full persona, history, relationships, and cardiology expertise.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/Iceberg.png" alt="Iceberg Thumbnail" />
      <div class="card-content">
        <h4>Iceberg</h4>
        <p>AI knowledge navigation system inspired by Library of Babel and fractals.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/ZEN.jpg" alt="ZENread App Thumbnail" />
      <div class="card-content">
        <h4>ZENread App</h4>
        <p>Reading app turning dense text into manageable, engaging, task-based segments.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/VISE.png" alt="Vise Thumbnail" />
      <div class="card-content">
        <h4>VISE</h4>
        <p>Soft-AI project simulating human visual focus with motion-tracking heuristics.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/Cabin.jpg" alt="Cabin Thumbnail" />
      <div class="card-content">
        <h4>Cabin</h4>
        <p>Author’s writing management app inspired by a creative retreat “cabin in the woods.”</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="apps-ai">
      <img src="assets/projects/Pearl.jpg" alt="Pearl Thumbnail" />
      <div class="card-content">
        <h4>Pearl</h4>
        <p>Voice-controlled photo editing with intuitive UI for non-professional creative users.</p>
      </div>
    </div>

    <!-- Music -->
    <div class="project-card" data-tilt data-section="music">
      <img src="Gente Como Tú.jpg" alt="Gente Como Tú Thumbnail" />
      <div class="card-content">
        <h4>Gente Como Tú</h4>
        <p>An original pop song that explores themes of connection and identity in the modern world.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="music">
      <img src="assets/projects/Underneath.jpg" alt="Underneath Thumbnail" />
      <div class="card-content">
        <h4>Underneath</h4>
        <p>An introspective alternative track that delves into themes of self-discovery and hidden emotions.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="music">
      <img src="assets/projects/AlmA.png" alt="AʟᴍA Thumbnail" />
      <div class="card-content">
        <h4>AʟᴍA</h4>
        <p>AʟᴍA is an experimental electronic composition that blends ambient textures with rhythmic elements.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="music">
      <img src="assets/projects/BlackRose.jpg" alt="BlackRose Thumbnail" />
      <div class="card-content">
        <h4>BlackRose</h4>
        <p>BlackRose is a haunting dark pop track with cinematic elements that tell a story of transformation and resilience.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="music">
      <img src="assets/projects/Siberia.jpg" alt="Siberia Thumbnail" />
      <div class="card-content">
        <h4>Siberia</h4>
        <p>Siberia is an atmospheric soundscape that captures the vastness and isolation of remote landscapes.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="music">
      <img src="assets/projects/Myth of Rebirth.jpg" alt="Poetry Collection Thumbnail" />
      <div class="card-content">
        <h4>The Myth of Rebirth</h4>
        <p>A collection of philosophical songs exploring a minimal writing and production style.</p>
      </div>
    </div>

    <!-- Writing -->
    <div class="project-card" data-tilt data-section="writing">
      <img src="assets/projects/The%20Arcane.jpg" alt="The Arcane Thumbnail" />
      <div class="card-content">
        <h4>The Arcane</h4>
        <p>Low fantasy novel for young adults, exploring loneliness, politics, and mythology in a multicultural world.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="writing">
      <img src="assets/projects/Downfall.jpg" alt="Downfall Thumbnail" />
      <div class="card-content">
        <h4>Downfall</h4>
        <p>Western duel animation subverting clichés with fresh 2D style and themes of vengeance.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="writing">
      <img src="assets/projects/A%20Dark%20Place.jpg" alt="A Dark Place Thumbnail" />
      <div class="card-content">
        <h4>A Dark Place</h4>
        <p>Psychological sci-fi manga blending high school drama, advanced physics, and themes of friendship and humanity.</p>
      </div>
    </div>

    <div class="project-card" data-tilt data-section="writing">
      <img src="assets/projects/blackhat.jpg" alt="Black Hat Thumbnail" />
      <div class="card-content">
        <h4>Black Hat</h4>
        <p>Futuristic manga exploring VR, AR, hacking, and biohacking in a corporate dystopia through a young hacker’s journey.</p>
      </div>
    </div>
  </div>
</section>

<script>
(() => {
  const root = document.getElementById('projects');
  const track = root?.querySelector('.projects-grid');
  if (!root || !track) return;

  const cards = Array.from(track.querySelectorAll('.project-card'));
  const N = cards.length;

  /* ===== Security (scoped) ===== */
  const stop = (e) => { e.preventDefault(); e.stopPropagation(); return false; };
  ['selectstart','copy','cut','paste','contextmenu','dragstart'].forEach(evt =>
    root.addEventListener(evt, stop, { capture: true })
  );
  root.querySelectorAll('img').forEach(img => {
    img.setAttribute('draggable', 'false');
    img.addEventListener('auxclick', stop, { capture: true });
    img.addEventListener('mousedown', e => { if (e.button !== 0) stop(e); }, { capture: true });
  });

  /* ===== Carousel config ===== */
  let current = 0;
  const SIDE_VISIBLE = 3;     // show per side
  const ROTY = 82;            // strong tilt
  const ZSTEP = 160;          // depth per step
  const SCALE_DECAY = 0.86;

  function mod(a,b){ return ((a%b)+b)%b; }
  function signedDistance(i, j) {
    let d = mod(i - j, N);
    if (d > N/2) d -= N;
    return d; // negative left, positive right
  }

  function sizeContainer() {
    const c = cards[current];
    const h = Math.max(420, c.offsetHeight + 24);
    track.style.setProperty('--carousel-h', h + 'px');
  }

  function layout() {
    const rect = track.getBoundingClientRect();
    const cardW = Math.max(260, Math.min(rect.width * 0.32, 460));
    const edgeRoom = Math.max(cardW * 0.55, 120);
    const SPACING = Math.min(rect.width / 2 - edgeRoom, cardW * 1.05);

    cards.forEach((card, i) => {
      const d = signedDistance(i, current);
      const ad = Math.abs(d);

      if (ad === 0) {
        card.style.opacity = '1';
        card.style.zIndex = 1000;
        card.style.transform =
          `translate(-50%,-50%) translateX(0px) rotateY(0deg) translateZ(0px) scale(1)`;
        card.style.visibility = 'visible';
        return;
      }

      if (ad > SIDE_VISIBLE) {
        const dir = d > 0 ? 1 : -1;
        const farX = dir * (SPACING * (SIDE_VISIBLE + 0.75));
        card.style.opacity = '0';
        card.style.transform =
          `translate(-50%,-50%) translateX(${farX}px) rotateY(${dir * -ROTY}deg) translateZ(${-ZSTEP*(SIDE_VISIBLE+1)}px) scale(${Math.pow(SCALE_DECAY, SIDE_VISIBLE+1)})`;
        card.style.zIndex = 1000 - (SIDE_VISIBLE + 2);
        return;
      }

      const dir = d > 0 ? 1 : -1;
      const x = dir * (SPACING * ad);
      const z = -ZSTEP * ad;
      const rot = dir * -ROTY;
      const scale = Math.pow(SCALE_DECAY, ad);

      card.style.opacity = '1';
      card.style.transform =
        `translate(-50%,-50%) translateX(${x}px) rotateY(${rot}deg) translateZ(${z}px) scale(${scale})`;
      card.style.zIndex = 1000 - (ad + 1);
      card.style.visibility = 'visible';
    });

    sizeContainer();
  }

  function step(dir) {
    current = dir === 'right' ? mod(current + 1, N) : mod(current - 1, N);
    layout();
  }

  /* ===== Hover scrolling over FULL width (desktop) ===== */
  const SLOW = 3000; // ms per step at inner edge
  const FAST = 300;  // ms per step at outer edge
  const EASE = 2.0;

  let hoverDir = null, intervalMs = SLOW, accum = 0, lastTs = null, inside = false, lastMouse = {x:0,y:0};

  function mapSpeed(xNorm) {
    // full-width zones: 0..0.5 left, 0.5..1 right
    if (xNorm > 0.5) {
      const r = Math.pow((xNorm - 0.5) / 0.5, EASE);
      return { dir: 'right', ms: SLOW - r * (SLOW - FAST) };
    } else if (xNorm < 0.5) {
      const l = Math.pow((0.5 - xNorm) / 0.5, EASE);
      return { dir: 'left', ms: SLOW - l * (SLOW - FAST) };
    }
    return { dir: null, ms: SLOW };
  }

  track.addEventListener('mousemove', (e) => {
    const rect = track.getBoundingClientRect();
    const x = (e.clientX - rect.left) / rect.width;
    lastMouse = { x: e.clientX, y: e.clientY };
    const { dir, ms } = mapSpeed(Math.min(1, Math.max(0, x)));
    hoverDir = dir;
    intervalMs = ms;
    inside = true;
  }, { passive: true });

  track.addEventListener('mouseenter', () => { inside = true; lastTs = null; }, { passive: true });
  track.addEventListener('mouseleave', () => { inside = false; hoverDir = null; accum = 0; }, { passive: true });

  /* ===== Wheel/trackpad on CENTER card only ===== */
  function isOverCenterCard(px, py) {
    const c = cards[current];
    const r = c.getBoundingClientRect();
    return px >= r.left && px <= r.right && py >= r.top && py <= r.bottom;
  }
  track.addEventListener('wheel', (e) => {
    if (!isOverCenterCard(e.clientX, e.clientY)) return; // let page scroll
    e.preventDefault(); // horizontal navigate
    if (e.deltaY > 0 || e.deltaX > 0) step('right');
    else if (e.deltaY < 0 || e.deltaX < 0) step('left');
  }, { passive: false });

  /* ===== Animation loop ===== */
  function loop(ts) {
    if (lastTs == null) lastTs = ts;
    const dt = ts - lastTs;
    lastTs = ts;

    if (inside && hoverDir) {
      accum += dt;
      if (accum >= intervalMs) {
        accum %= intervalMs;
        step(hoverDir);
      }
    } else {
      accum = 0;
    }
    requestAnimationFrame(loop);
  }

  /* ===== Mobile: swipe left/right ===== */
  let touchStartX = 0, touchStartY = 0, moved = false;
  const SWIPE_MIN = 35;

  track.addEventListener('touchstart', (e) => {
    const t = e.changedTouches[0];
    touchStartX = t.clientX; touchStartY = t.clientY; moved = false;
  }, { passive: true });

  track.addEventListener('touchmove', (e) => {
    const t = e.changedTouches[0];
    const dx = t.clientX - touchStartX;
    const dy = t.clientY - touchStartY;
    if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 8) {
      e.preventDefault(); // horizontal intent
      moved = true;
    }
  }, { passive: false });

  track.addEventListener('touchend', (e) => {
    if (!moved) return;
    const t = e.changedTouches[0];
    const dx = t.clientX - touchStartX;
    if (Math.abs(dx) >= SWIPE_MIN) {
      step(dx < 0 ? 'right' : 'left');
    }
  }, { passive: false });

  /* ===== Prime ===== */
  cards.forEach(card => {
    card.style.position = 'absolute';
    card.style.top = '50%';
    card.style.left = '50%';
    card.style.width = 'var(--card-w, clamp(260px, 34vw, 460px))';
    card.style.transform = 'translate(-50%,-50%)';
    card.style.transition = 'transform 600ms cubic-bezier(.2,.6,.2,1), opacity 250ms';
    card.style.willChange = 'transform';
    card.style.backfaceVisibility = 'hidden';
    card.style.transformOrigin = '50% 50%';
  });

  window.addEventListener('resize', layout);

  const imgs = root.querySelectorAll('img');
  let loaded = 0;
  const start = () => { layout(); requestAnimationFrame(loop); };
  if (!imgs.length) start();
  imgs.forEach(img => {
    if (img.complete) { if (++loaded === imgs.length) start(); }
    else {
      img.addEventListener('load', () => { if (++loaded === imgs.length) start(); });
      img.addEventListener('error', () => { if (++loaded === imgs.length) start(); });
    }
  });
})();
</script>
